# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –∫ –∑–∞–Ω—è—Ç–∏—é ¬´–í–≤–µ–¥–µ–Ω–∏–µ –≤ Terraform¬ª

### –¶–µ–ª–∏ –∑–∞–¥–∞–Ω–∏—è

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Terrafrom.
2. –ù–∞—É—á–∏—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥.

------

### –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –¥–æ–º–∞—à–Ω–µ–º—É –∑–∞–¥–∞–Ω–∏—é

1. –°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ **Terraform** –≤–µ—Ä—Å–∏–∏ >=1.8.4 . –ü—Ä–∏–ª–æ–∂–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã ```terraform --version```.
   ![PNG](https://github.com/Dun9Dev/ter-hw-01/blob/main/img/Screenshot_2.png)
3. –°–∫–∞—á–∞–π—Ç–µ –Ω–∞ —Å–≤–æ–π –ü–ö —ç—Ç–æ—Ç git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ **01/src**.
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –≤–∞—à–µ–π –û–° —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω docker.

------

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è

1. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –∑–µ—Ä–∫–∞–ª–æ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Terraform: [—Å—Å—ã–ª–∫–∞](https://github.com/netology-code/devops-materials).
2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ docker: [—Å—Å—ã–ª–∫–∞](https://docs.docker.com/engine/install/ubuntu/). 
------
### –í–Ω–∏–º–∞–Ω–∏–µ!! –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è –∫–æ–¥ –≤ –≤–∏–¥–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–∞—à github-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π!
------

### –ó–∞–¥–∞–Ω–∏–µ 1

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–∞—Ç–∞–ª–æ–≥ [**src**](https://github.com/netology-code/ter-homeworks/tree/main/01/src). –°–∫–∞—á–∞–π—Ç–µ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ. 
2. –ò–∑—É—á–∏—Ç–µ —Ñ–∞–π–ª **.gitignore**. –í –∫–∞–∫–æ–º terraform-—Ñ–∞–π–ª–µ, —Å–æ–≥–ª–∞—Å–Ω–æ —ç—Ç–æ–º—É .gitignore, –¥–æ–ø—É—Å—Ç–∏–º–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–∏—á–Ω—É—é, —Å–µ–∫—Ä–µ—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é?(–ª–æ–≥–∏–Ω—ã,–ø–∞—Ä–æ–ª–∏,–∫–ª—é—á–∏,—Ç–æ–∫–µ–Ω—ã –∏—Ç–¥)
   - –°–æ–≥–ª–∞—Å–Ω–æ .gitignore, —Å–µ–∫—Ä–µ—Ç—ã –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª–µ personal.auto.tfvars, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
     # own secret vars store.
     personal.auto.tfvars
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞. –ù–∞–π–¥–∏—Ç–µ  –≤ state-—Ñ–∞–π–ª–µ —Å–µ–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ **random_password**, –ø—Ä–∏—à–ª–∏—Ç–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –∏ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ.
    - "result": "gwypvAOKOxqXo27j"
6. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –±–ª–æ–∫ –∫–æ–¥–∞, –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –Ω–∞ —Å—Ç—Ä–æ—á–∫–∞—Ö 29‚Äì42 —Ñ–∞–π–ª–∞ **main.tf**.
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É ```terraform validate```. –û–±—ä—è—Å–Ω–∏—Ç–µ, –≤ —á—ë–º –∑–∞–∫–ª—é—á–∞—é—Ç—Å—è –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –¥–æ–ø—É—â–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏. –ò—Å–ø—Ä–∞–≤—å—Ç–µ –∏—Ö.
  - –í –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –±–ª–æ–∫–µ –∫–æ–¥–∞ –±—ã–ª–∏ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –¥–æ–ø—É—â–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –æ—à–∏–±–∫–∏:

 1. –£ —Ä–µ—Å—É—Ä—Å–∞ `docker_image` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–æ –∏–º—è, –∏–∑-–∑–∞ —á–µ–≥–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ—Å–ª–∞—Ç—å—Å—è –Ω–∞ –Ω–µ–≥–æ –≤ `docker_container`.  
    **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –¥–æ–±–∞–≤–ª–µ–Ω–æ –∏–º—è `nginx`: `resource "docker_image" "nginx"`

 2. –ò–º—è —Ä–µ—Å—É—Ä—Å–∞ `docker_container "1nginx"` –Ω–∞—á–∏–Ω–∞–ª–æ—Å—å —Å —Ü–∏—Ñ—Ä—ã, —á—Ç–æ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ –≤ Terraform.  
   **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `nginx_container`.

 3. –í –≤—ã—Ä–∞–∂–µ–Ω–∏–∏ `random_password.random_string_FAKE.resulT` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –∏–º—è —Ä–µ—Å—É—Ä—Å–∞ (`_FAKE`) –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ (`resulT` –≤–º–µ—Å—Ç–æ `result`).  
    **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `random_password.random_string.result`.
 –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π `terraform validate` –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ.

8. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–¥. –í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏–ª–æ–∂–∏—Ç–µ: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∏ –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã ```docker ps```.
   ![PNG](https://github.com/Dun9Dev/ter-hw-01/blob/main/img/Screenshot_3.png)
   ```
   resource "docker_image" "nginx" {
    name         = "nginx:latest"
    keep_locally = true
    }

    resource "docker_container" "nginx_container" {
     name  = "hello_world"
    image = docker_image.nginx.image_id

    ports {
      internal = 80
      external = 9090
    }
    }
   ```
10. –ó–∞–º–µ–Ω–∏—Ç–µ –∏–º—è docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ –±–ª–æ–∫–µ –∫–æ–¥–∞ –Ω–∞ ```hello_world```. –ù–µ –ø–µ—Ä–µ–ø—É—Ç–∞–π—Ç–µ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –∏–º—è –æ–±—Ä–∞–∑–∞. –ú—ã –≤—Å—ë –µ—â—ë –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å name = "nginx:latest". –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É ```terraform apply -auto-approve```.
–û–±—ä—è—Å–Ω–∏—Ç–µ —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –≤ —á—ë–º –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–ª—é—á–∞  ```-auto-approve```. –î–æ–≥–∞–¥–∞–π—Ç–µ—Å—å –∏–ª–∏ –Ω–∞–≥—É–≥–ª–∏—Ç–µ –∑–∞—á–µ–º –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –¥–∞–Ω–Ω—ã–π –∫–ª—é—á? –í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–ª–æ–∂–∏—Ç–µ –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã ```docker ps```.
![PNG](https://github.com/Dun9Dev/ter-hw-01/blob/main/img/Screenshot_8.png)
–ö–ª—é—á -auto-approve –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ terraform apply.
–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∂–¥–∞—Ç—å, –ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–¥—ë—Ç yes, Terraform –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

–ü–æ—á–µ–º—É —ç—Ç–æ –æ–ø–∞—Å–Ω–æ? 

–ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–ª—É—á–∞–π–Ω–æ–º—É —É–¥–∞–ª–µ–Ω–∏—é –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—é –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –í–ú —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö, S3-–±–∞–∫–µ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏).
–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ (production) —Ç–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–∏, –ø–æ—Ç–µ—Ä—é –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏.
–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ "–ø–µ—Ä–µ–¥—É–º–∞—Ç—å" ‚Äî –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.
–ü—Ä–∏–º–µ—Ä:
–ï—Å–ª–∏ terraform plan –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ 5 –í–ú, –∞ —Ç—ã –Ω–µ –∑–∞–º–µ—Ç–∏–ª ‚Äî —Å -auto-approve –æ–Ω–∏ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è.

12. –£–Ω–∏—á—Ç–æ–∂—å—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã —Å –ø–æ–º–æ—â—å—é **terraform**. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã —É–¥–∞–ª–µ–Ω—ã. –ü—Ä–∏–ª–æ–∂–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ **terraform.tfstate**.
    ![PNG](https://github.com/Dun9Dev/ter-hw-01/blob/main/img/Screenshot_9.png)
14. –û–±—ä—è—Å–Ω–∏—Ç–µ, –ø–æ—á–µ–º—É –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –±—ã–ª —É–¥–∞–ª—ë–Ω docker-–æ–±—Ä–∞–∑ **nginx:latest**. –û—Ç–≤–µ—Ç **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ù–ê–ô–î–ò–¢–ï –í –ü–†–ï–î–û–°–¢–ê–í–õ–ï–ù–ù–û–ú –ö–û–î–ï**, –∞ –∑–∞—Ç–µ–º **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ü–û–î–ö–†–ï–ü–ò–¢–ï** —Å—Ç—Ä–æ—á–∫–æ–π –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ [**terraform –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ docker**](https://docs.comcloud.xyz/providers/kreuzwerker/docker/latest/docs).  (–∏—â–∏—Ç–µ –≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–µ resource docker_image )
    -–±—Ä–∞–∑ nginx:latest –Ω–µ –±—ã–ª —É–¥–∞–ª—ë–Ω –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ terraform destroy, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ —Ä–µ—Å—É—Ä—Å–µ docker_image —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:
```
keep_locally = true
```
–≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã, –¥–∞–∂–µ –µ—Å–ª–∏ —Ä–µ—Å—É—Ä—Å —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è.

–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ Docker –¥–ª—è Terraform:

keep_locally (Boolean) If true, then the Docker image won't be deleted on destroy operation. 

üîó https://registry.terraform.io/providers/kreuzwerker/docker/latest/docs/resources/image#keep_locally 


------
